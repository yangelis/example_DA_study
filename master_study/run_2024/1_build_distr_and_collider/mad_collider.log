mylhcbeam = 1;

      ! Get the toolkit
      call,file=
        "acc-models-lhc/toolkit/macro.madx";
      ;

      ! Build sequence
      option, -echo,-warn,-info;
      if (mylhcbeam==4){
        call,file="acc-models-lhc/lhc_acc-models-lhc_b4.seq";
      } else {
        call,file="acc-models-lhc/lhc_acc-models-lhc.seq";
      };
      option, -echo, warn,-info;
      ;

      ! Slice nominal sequence
      ! exec, myslice;
      ;

    nrj=6800;
    beam,particle=proton,sequence=lhcb1,energy=nrj,npart=1.15E11,sige=4.5e-4;
    beam,particle=proton,sequence=lhcb2,energy=nrj,bv = -1,npart=1.15E11,sige=4.5e-4;
    ;

        !Cycling w.r.t. to IP3 (mandatory to find closed orbit in collision in the presence of errors)
        if (mylhcbeam<3){
        seqedit, sequence=lhcb1; flatten; cycle, start=IP3; flatten; endedit;
        };
        seqedit, sequence=lhcb2; flatten; cycle, start=IP3; flatten; endedit;
        ;

        ! Set twiss formats for MAD-X parts (macro from opt. toolkit)
        exec, twiss_opt;
        ;
call, file="acc-models-lhc/RunIII_dev/Proton_2024/V0/opticsfile.34";
on_alice := on_alice_normalized * 7000./nrj;
on_lhcb := on_lhcb_normalized * 7000./nrj;
bv_aux = 1;

    beam, particle=proton,sequence=lhcb1,
        energy=6800,
        sigt=0.0001,
        bv=1,
        npart=1,
        sige=1e-06,
        ex=1.379811894352941e-10,
        ey=1.379811894352941e-10,
        mass=0.93827208816,
        charge=1.0;
    ;
use, sequence=lhcb1;
use, sequence=lhcb1;
twiss;

    beam, particle=proton,sequence=lhcb2,
        energy=6800,
        sigt=0.0001,
        bv=-1,
        npart=1,
        sige=1e-06,
        ex=1.379811894352941e-10,
        ey=1.379811894352941e-10,
        mass=0.93827208816,
        charge=1.0;
    ;
use, sequence=lhcb2;
use, sequence=lhcb2;
twiss;
